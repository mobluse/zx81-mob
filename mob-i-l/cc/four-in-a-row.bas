   5 RUN 10
   9 SAVE "FOUR IN A RO%W"
  10 SCROLL
  11 PRINT TAB 8;"FOUR IN A ROW"
  20 SCROLL
  21 PRINT TAB 6;"CREATIVE COMPUTING"
  30 SCROLL
  31 PRINT TAB 4;"MORRISTOWN, NEW JERSEY"
  40 SCROLL
  41 SCROLL
  42 SCROLL
 100 DIM B$(8,8)
 101 DIM L(8)
 102 DIM S(4)
 103 DIM F(4)
 110 DIM V(16)
 111 DIM N(4)
 130 LET V(1)=1
 131 LET V(2)=100
 132 LET V(3)=500
 133 LET V(4)=1E20
 134 LET V(5)=1
 135 LET V(6)=800
 136 LET V(7)=4000
 137 LET V(8)=1E20
 138 LET V(9)=1
 139 LET V(10)=75
 140 LET V(11)=900
 141 LET V(12)=1E18
 142 LET V(13)=1
 143 LET V(14)=450
 144 LET V(15)=3000
 145 LET V(16)=1E18
 160 SCROLL
 161 PRINT "THE GAME OF FOUR IN A ROW."
 170 SCROLL
 171 PRINT "DO YOU WANT INSTRUCTIONS? ";
 172 INPUT A$
 173 PRINT A$
 180 IF A$(1)="N" THEN GOTO 270
 190 IF A$(1)="Y" THEN GOTO 210
 200 SCROLL
 201 PRINT "YES OR NO"
 203 GOTO 170
 210 SCROLL
 211 PRINT "THE GAME CONSISTS OF STACKING"
 212 SCROLL
 213 PRINT "X""S AND O""S (THE COMPUTER"
 220 SCROLL
 221 PRINT "HAS O) UNTIL ONE OF THE PLAYERS"
 230 SCROLL
 231 PRINT "GETS FOUR IN A ROW VERTICALLY,"
 240 SCROLL
 241 PRINT "HORIZONTALLY, OR DIAGONALLY."
 260 SCROLL
 261 SCROLL
 270 LET X$="X"
 271 LET O$="O"
 280 FOR I=1 TO 8
 281 FOR J=1 TO 8
 282 LET B$(I,J)="-"
 283 NEXT J
 284 NEXT I
 290 DIM L(8)
 300 SCROLL
 301 PRINT "DO YOU WANT TO GO FIRST? ";
 302 INPUT A$
 303 PRINT A$
 305 SCROLL
 310 IF A$(1)="N" THEN GOTO 610
 320 GOSUB 340
 330 GOTO 450
 340 SLOW
 341 SCROLL
 342 FOR I=8 TO 1 STEP -1
 350 FOR J=1 TO 8
 360 PRINT "  ";B$(I,J);
 370 NEXT J
 380 SCROLL
 390 NEXT I
 410 FOR I=1 TO 8
 411 PRINT "  ";I;
 412 NEXT I
 420 SCROLL
 421 SCROLL
 430 RETURN
 440 SCROLL
 441 PRINT "ILLEGAL MOVE, TRY AGAIN."
 450 SCROLL
 451 PRINT "A NUMBER BETWEEN 1 AND 8? ";
 452 INPUT M
 453 PRINT M
 460 LET M=INT M
 470 IF M<1 OR M>8 THEN GOTO 440
 480 LET L=L(M)
 490 IF L>7 THEN GOTO 440
 500 LET L(M)=L+1
 501 LET L=L+1
 510 LET B$(L,M)=X$
 520 SCROLL
 540 LET P$=X$
 550 GOSUB 1240
 560 FOR Z=1 TO 4
 570 IF S(Z)<4 THEN GOTO 600
 580 SCROLL
 581 PRINT "Y O U   W I N ."
 590 GOTO 1580
 600 NEXT Z
 610 LET M9=0
 611 LET V1=0
 615 FAST
 620 LET N1=1
 630 FOR P=1 TO 8
 640 LET L=L(P)+1
 650 IF L>8 THEN GOTO 1080
 660 LET V=1
 670 LET P$=O$
 671 LET W=0
 680 LET M=P
 690 GOSUB 1240
 700 DIM N(4)
 710 FOR Z=1 TO 4
 720 LET S=S(Z)
 730 IF S-W>3 THEN GOTO 1130
 740 LET T=S+F(Z)
 750 IF T<4 THEN GOTO 780
 760 LET V=V+4
 770 LET N(S)=N(S)+1
 780 NEXT Z
 790 FOR I=1 TO 4
 800 LET N=N(I)-1
 810 IF N=-1 THEN GOTO 840
 820 LET I1=8*W+4*SGN (N)+I
 830 LET V=V+V(I1)+N*V(8*W+I)
 840 NEXT I
 850 IF W=1 THEN GOTO 880
 860 LET W=1
 861 LET P$=X$
 870 GOTO 690
 880 LET L=L+1
 920 IF L>8 THEN GOTO 1020
 930 GOSUB 1240
 940 FOR Z=1 TO 4
 950 IF S(Z)>3 THEN LET V=2
 960 NEXT Z
1020 IF V<V1 THEN GOTO 1080
1030 IF V>V1 THEN LET N1=1
1031 IF V>V1 THEN GOTO 1060
1040 LET N1=N1+1
1050 IF RND>1/N1 THEN GOTO 1080
1060 LET V1=V
1070 LET M9=P
1080 NEXT P
1090 IF M9<>0 THEN GOTO 1120
1100 SCROLL
1101 PRINT "T I E   G A M E . . ."
1110 GOTO 1580
1120 LET M=M9
1130 SCROLL
1131 PRINT "COMPUTER PICKS COLUMN ";M
1132 SCROLL
1140 LET L=L(M)+1
1141 LET L(M)=L(M)+1
1150 LET B$(L,M)=O$
1160 LET P$=O$
1161 GOSUB 340
1170 GOSUB 1240
1180 FOR Z=1 TO 4
1190 IF S(Z)<4 THEN GOTO 1220
1200 SCROLL
1201 PRINT "C O M P U T E R   W I N S ."
1210 GOTO 1580
1220 NEXT Z
1230 GOTO 450
1240 LET Q$=X$
1250 IF P$=X$ THEN LET Q$=O$
1260 LET D2=1
1261 LET D1=0
1270 LET Z=0
1280 GOSUB 1360
1290 LET D1=1
1291 LET D2=1
1300 GOSUB 1360
1310 LET D2=0
1311 LET D1=1
1320 GOSUB 1360
1330 LET D2=-1
1331 LET D1=1
1340 GOSUB 1360
1350 RETURN
1360 LET D=1
1361 LET S=1
1370 LET T=0
1380 LET Z=Z+1
1390 LET C=0
1400 FOR K=1 TO 3
1410 LET M5=M+K*D1
1411 LET L1=L+K*D2
1420 IF M5<1 OR L1<1 OR M5>8 OR L1>8 THEN GOTO 1510
1430 LET C$=B$(L1,M5)
1440 IF C=0 THEN GOTO 1480
1450 IF C$=Q$ THEN LET K=3
1451 IF C$=Q$ THEN GOTO 1510
1460 LET T=T+1
1470 GOTO 1510
1480 IF C$=P$ THEN LET S=S+1
1481 IF C$=P$ THEN GOTO 1510
1490 LET C=1
1500 GOTO 1450
1510 NEXT K
1520 IF D=0 THEN GOTO 1550
1530 LET D=0
1531 LET D1=-D1
1532 LET D2=-D2
1540 GOTO 1390
1550 LET S(Z)=S
1560 LET F(Z)=T
1570 RETURN
1580 SLOW
1581 SCROLL
1582 SCROLL
1583 PRINT "PLAY AGAIN? ";
1584 INPUT A$
1585 PRINT A$
1586 IF A$(1)="Y" THEN GOTO 280
1587 IF A$(1)<>"N" THEN GOTO 1581
1588 CLEAR
1590 REM ----END-OF-PROGRAM-----
